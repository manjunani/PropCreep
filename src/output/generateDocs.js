import fs from 'fs-extra';
import path from 'path';

export async function generateDocs(components, tree, outputDir) {
  await fs.ensureDir(outputDir);

  for (const comp of components) {
    const outFile = path.join(outputDir, `${comp.name}.md`);
    const doc = `
# Component: ${comp.name}

**Path:** \`${comp.filePath}\`

### Props
${comp.props.map(p => `- \`${p.name}\`: \`${p.type}\``).join("\n")}

---
Generated by Component Docgen Tool
    `;
    await fs.writeFile(outFile, doc.trim());
  }

  await fs.writeJSON(path.join(outputDir, "components.json"), components, { spaces: 2 });
  await fs.writeJSON(path.join(outputDir, "component-tree.json"), tree, { spaces: 2 });
}
